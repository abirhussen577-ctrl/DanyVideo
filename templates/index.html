<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>DanyVideo - Free Video Downloader</title>
  <link rel="icon" href="{{ url_for('static', filename='icon.png') }}">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">

  <style>
    body { font-family: 'Poppins', sans-serif; background: #f9f9f9; margin:0; padding:0; text-align:center; }
    header { background: linear-gradient(90deg, #4cafef, #00c896); color:white; padding:20px; font-size:1.5rem; font-weight:600; display:flex; justify-content:center; align-items:center; }
    header img { height:45px; margin-right:10px; animation: spin 4s linear infinite; }
    @keyframes spin { from{transform:rotate(0)} to{transform:rotate(360deg)} }
    .container { margin-top:40px; }
    input[type=text] { width:60%; padding:12px; border-radius:50px; border:2px solid #4cafef; }
    button { padding:12px 25px; margin-left:10px; background:#00c896; border:none; color:white; border-radius:50px; cursor:pointer; }
    button:hover { background:#009f78; }
    #results { margin-top:30px; text-align:left; width:70%; margin-left:auto; margin-right:auto; }
    .video-card { background:white; border-radius:15px; padding:20px; box-shadow:0 2px 6px rgba(0,0,0,0.2); }
    .video-card img { width:200px; border-radius:10px; }
    .formats a { display:block; margin:8px 0; padding:10px; background:#4cafef; color:white; text-decoration:none; border-radius:8px; text-align:center; }
    .formats a:hover { background:#2196f3; }
  </style>
</head>
<body>
  <header>
    <img src="{{ url_for('static', filename='logo.png') }}" alt="Logo"> DanyVideo
  </header>

  <div class="container">
    <form id="urlForm">
      <input type="text" id="url" placeholder="Enter video URL...">
      <button type="submit">Get Video</button>
    </form>

    <div id="results"></div>
  </div>

  <script>
    document.getElementById("urlForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      let url = document.getElementById("url").value;
      if (!url) return;

      document.getElementById("results").innerHTML = "<p>‚è≥ Fetching video info...</p>";

      let res = await fetch("/api/getinfo", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ url: url })
      });

      let data = await res.json();

      if (data.error) {
        document.getElementById("results").innerHTML = `<p style="color:red">${data.error}</p>`;
      } else {
        let html = `
          <div class="video-card">
            <h2>${data.title}</h2>
            <img src="${data.thumbnail}" alt="thumbnail">
            <div class="formats">
        `;
        data.formats.forEach(f => {
          html += `<a href="/download?url=${encodeURIComponent(url)}&format_id=${f.format_id}">${f.format_note || f.resolution} (${f.ext})</a>`;
        });
        html += "</div></div>";
        document.getElementById("results").innerHTML = html;
      }
    });
  </script>
</body>
</html>
